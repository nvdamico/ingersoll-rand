/*
Widget:   q4.addtocal
Version:  1.0.4
Compiled: 2017-03-08
*/
!function(a){a.widget("q4.addToCalendar",{options:{listSelector:".calendarList",buttonSelector:".q4-atc-button",tooltip:!1,fancybox:!1,tpl:function(a){return'<div class="q4-atc-wrapper"><a href="#!" class="q4-atc-button">Add to Calendar</a><div class="q4-atc-outer" style="display: none;"><div class="q4-atc-inner"><div class="q4-atc-inner-details"><div class="q4-atc-title">Select your Calendar</div>'+a+'</div><div class="q4-atc-tooltip" style="display: none;"><span class="q4-atc-tooltip-text"></span></div></div></div></div>'}},_init:function(){var a=this,b=a.options;a._buildHTML(),a._onClickToAdd(),b.fancybox||(a._closeAddToCalendar(),b.tooltip&&a._onIconHover(a.element)),a._onWindowResize(function(){a._clearPopups()})},_closeAddToCalendar:function(){var b=this;a(document).on("click",function(c){0===a(c.target).closest(".AddToCalendar").length&&b._clearPopups()})},_buildHTML:function(){var b=this;b.element.find(b.options.listSelector).each(function(){var c=a(this);c.addClass("q4-atc-links"),c.find("a span").addClass("visuallyhidden");var d=c[0].outerHTML,e=b.options.tpl(d);c.after(e),c.remove()})},_onClickToAdd:function(){var b=this;b.element.on("click",b.options.buttonSelector,function(c){if(c.preventDefault(),c.stopPropagation(),b.options.fancybox){var d=a('<div class="q4-atc-wrapper">'+a(this).siblings(".q4-atc-outer").html()+"</div>");a.fancybox.open(d),b.options.tooltip&&b._onIconHover(d)}else b._togglePopup(a(this).siblings(".q4-atc-outer"))})},_onIconHover:function(b){b.find(".q4-atc-links a").on("mouseenter",function(){var b=a(this),c=b.parents(".q4-atc-inner").find(".q4-atc-tooltip"),d=b.children("span").html();c.children(".q4-atc-tooltip-text").html(d),c.stop(!0,!0).fadeIn(100)}).on("mouseleave",function(){a(this).parents(".q4-atc-inner").find(".q4-atc-tooltip").stop(!0,!0).fadeOut(100)})},_togglePopup:function(b){b.hasClass("is-active")?b.removeClass("is-active").stop(!0,!0).fadeOut(200):(a(".q4-atc-outer").stop(!0,!0).fadeOut(200),b.addClass("is-active").stop(!0,!0).fadeIn(200))},_clearPopups:function(){a(".q4-atc-outer").removeClass("is-active").stop(!0,!0).fadeOut(200)},_onWindowResize:function(b){var c,d=a(window).height(),e=a(window).width();a(window).on("resize orientationChanged",function(){a(window).height()==d&&a(window).width()==e||(d=a(window).height(),e=a(window).width(),clearTimeout(c),c=setTimeout(b,40))})},destroy:function(){this.element.html("")},_setOption:function(a,b){this._superApply(arguments)}})}(jQuery);